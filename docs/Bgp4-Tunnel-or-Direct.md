<div dir="rtl">

پروتکل bgp4 که بر اساس استانداردش روی tcp سوار شده ؛ روش ارتباط روتر ها با هم هستش

روش Bg4 بر خلاف اسمش خیلی ساده هست ؛ یه ترنسپورته که میتونید اضافه کنید

پرتوکل Bgp دارای state هست که فعلا به شکل ساده شبیه سازی شده

شما نیاز دارید هم در سرور ایران و هم خارج واتروال رو اجرا کنید

این روش جادویی نیست ؛ قرار نیست ایپی ای که اتصال بهش بلاک شده رو انبلاک کنه البته تست کردنش خالی از لطف نیست ولی خوب روی یه هتزنر که ایپی اش کامل کثیف بود و کلا هیچ روش مستقیمی وصل نمیشد بهش 
تست کردیم و مستقیم وصل نشد ؛‌ ریورس ولی چرا

این رو میشه به راحتی ریورس هم زد با ترکیب با نود های ریورس

بر روی این روش نیازی به رمز نگاری نیست

مهم ترین هدفی که من انتظار دارم اینه که این روش بتونه پایدار بمونه و باهاش تونل مستقیم بزنیم ؛‌همچنین این روش سبک هست و پرسرعت

البته انتظار میره ازش که بتونه محدویت هایی که روی مستقیم ها میزارن رو رفع کنه چون کانکشن اش کلا طور دیگه ای هست و tls نداره و هدر خاص خودشو داره کاملا

فعلا چون خودم کامل تست نکردم دیدگاه دقیقی ندارم و هرچی هم که گفتم روی احتمالات بود همونطور که خوندین ؛‌برای تست اش به روش مستقیم من این کانفیگ رو استفاده میکنم


# سرور ایران

ایپی خارج 1.1.1.1 فرض شده و همچنین پورت سرور خارج به شدت پیشناهاد میشه طبق استنادارد bgp 179 باشه

</div>


```json

{
    "name": "bgp_client",
    "nodes": [
        {
            "name": "input",
            "type": "TcpListener",
            "settings": {
                "address": "0.0.0.0",
                "port": 443,
                "nodelay": true
            },
            "next": "bgp_client"
        },
        {
            "name": "bgp_client",
            "type": "Bgp4Client",
            "settings": {},
            "next": "output"
        },
        {
            "name": "output",
            "type": "TcpConnector",
            "settings": {
                "nodelay": true,
                "address":"1.1.1.1",
                "port":179
            }
        }
    ]
}
```

<div dir="rtl">

# سرور خارج

</div>

```json
{
    "name": "bgp_server",
    "nodes": [
        {
            "name": "input",
            "type": "TcpListener",
            "settings": {
                "address": "0.0.0.0",
                "port": 179,
                "nodelay": true
            },
            "next": "bgp_server"
        },
        {
            "name":"bgp_server",
            "type":"Bgp4Server",
            "settings":{},
            "next":"output"
        },
        
        {
            "name": "output",
            "type": "TcpConnector",
            "settings": {
                "nodelay": true,
                "address": "127.0.0.1",
                "port": 443
            }
        }

    ]
}
```

<div dir="rtl">

این کانفیگ پورت 443 سرور ایران رو وصل میکنه به پورت ۴۴۳ سرور خارج و تک پورت هست ؛ مالتی پورت کردنش اصلا کاری نداره و فکر کنم همه میدونن چطوری ؛ مثالش هم تو ویکی ها گفتم قبلا که چه تغییری بدید

همچنین دقت کنید که bgp روی پورت ۱۷۹ هست و ارتباط ایران و خارج از طریق پورت ۱۷۹  شکل گرفته

برخلاف روش های قبل که میگفتیم ۴۴۳ پورت بهتریه ؛ اینجا ۱۷۹ پورت مد نظر هست


</div>











